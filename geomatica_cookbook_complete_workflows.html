<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Workflow Examples for the Left-side of Your Brain &mdash; Geomatica Cookbook 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/sidebar.js"></script>
    <link rel="top" title="Geomatica Cookbook 1.0.0 documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="index.html">Geomatica Cookbook 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="workflow-examples-for-the-left-side-of-your-brain">
<h1><strong>Workflow Examples for the Left-side of Your Brain</strong><a class="headerlink" href="#workflow-examples-for-the-left-side-of-your-brain" title="Permalink to this headline">¶</a></h1>
<p>This section provides some basic recipes for importing pci libraries, accessing help, error handling and etc.</p>
<div class="section" id="co-register-image-stack">
<h2>Co-register image stack<a class="headerlink" href="#co-register-image-stack" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Quickly check to ensure that Geomatica is correctly installed and licensed for your computer.
Use the Python interpreter in the terminal/console for quickly checking the install and licensing.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&#39;&#39;&#39;**************************************************************</span>

<span class="sd">       -= PCI Geomatics(C) Platform Solutions =-</span>
<span class="sd">      Formosat-2 Automatic Co-Registration Workflow</span>

<span class="sd">***************************************************************&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">pci.autogcp2</span> <span class="kn">import</span> <span class="n">autogcp2</span>
<span class="kn">from</span> <span class="nn">pci.rfmodel</span> <span class="kn">import</span> <span class="n">rfmodel</span>
<span class="kn">from</span> <span class="nn">pci.gcprefn</span> <span class="kn">import</span> <span class="n">gcprefn</span>
<span class="kn">from</span> <span class="nn">pci.satmodel</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.ortho2</span> <span class="kn">import</span> <span class="n">ortho2</span>
<span class="kn">from</span> <span class="nn">pci.fimport</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.cdformosat</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.exceptions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathcheck</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>

<span class="kn">import</span> <span class="nn">calendar</span><span class="o">,</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">ntpath</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span> <span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span> <span class="n">locale</span><span class="o">.</span><span class="n">LC_NUMERIC</span><span class="p">,</span> <span class="s">&quot;C&quot;</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">fail_log</span><span class="p">(</span><span class="n">fail_file</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">):</span>
<span class="c"># ------------------------------------------------</span>
<span class="c">#  Create a log file</span>
<span class="c"># ------------------------------------------------</span>
<span class="c"># The Log file creates a list of the files that failed to orthorectify.</span>
<span class="c"># The log is stored in a text file and is located in the output directory</span>
<span class="c"># specified by the user.</span>

    <span class="n">fail_log</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_dir</span> <span class="o">+</span> <span class="s">&quot;/fail_log.txt&quot;</span><span class="p">,</span> <span class="s">&quot;a+&quot;</span><span class="p">)</span>
    <span class="n">fail_log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fail_file</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">fail_log</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">ingest_formosat</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="n">out_file</span><span class="p">,</span> <span class="n">channel_list</span><span class="p">):</span>
<span class="c"># ------------------------------------------------</span>
<span class="c">#  Ingest Formosat with Rigorous Model</span>
<span class="c"># ------------------------------------------------</span>

    <span class="n">fili</span> <span class="o">=</span> <span class="n">in_file</span>
    <span class="n">filo</span> <span class="o">=</span> <span class="n">out_file</span>
    <span class="n">linkfile</span> <span class="o">=</span> <span class="s">u&quot;NO&quot;</span>
    <span class="n">cdic</span> <span class="o">=</span> <span class="n">channel_list</span>
    <span class="n">tex1</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">cdformosat</span><span class="p">(</span><span class="n">fili</span><span class="p">,</span> <span class="n">filo</span><span class="p">,</span> <span class="n">linkfile</span><span class="p">,</span> <span class="n">cdic</span><span class="p">,</span> <span class="n">tex1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>


<span class="k">def</span> <span class="nf">gcp_work</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="n">ref_image</span><span class="p">,</span> <span class="n">dem_file</span><span class="p">):</span>
<span class="c"># ------------------------------------------------</span>
<span class="c">#  GCP Collection and Refinement</span>
<span class="c"># ------------------------------------------------</span>
<span class="c"># This section performs automatic GCP collection from a reference source.</span>
<span class="c"># In the first iteration of the workflow, the reference image must be a 3rd party</span>
<span class="c"># reference dataset (e.g. Landsat). In this first iteration, only the first image</span>
<span class="c"># in the image stack will be orthorectified (based on GCPs collected from the 3rd</span>
<span class="c"># reference image.</span>
<span class="c"># In the second iteration, the script will use the ortho from the first image in</span>
<span class="c"># the stack as a reference to collect GCPs for the remaining images in the stack</span>

    <span class="k">print</span> <span class="s">&quot;Starting GCP Collection&quot;</span>
    <span class="k">print</span> <span class="s">&quot;&quot;</span>

    <span class="n">mfile</span> <span class="o">=</span> <span class="n">in_file</span>
    <span class="n">dbic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>      <span class="c"># Integer</span>
    <span class="n">srcbgd</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">mmseg</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">dbgc</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">filref</span> <span class="o">=</span> <span class="n">ref_image</span>
    <span class="n">dbic_ref</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">filedem</span> <span class="o">=</span> <span class="n">dem_file</span>
    <span class="n">dbec</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">backelev</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>
    <span class="n">elevref</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">elevunit</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">elfactor</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>
    <span class="n">smplsrc</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">searchr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>      <span class="c"># Integer</span>
    <span class="n">searchun</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">minscore</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">]</span>     <span class="c"># Float</span>
    <span class="n">proc</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">numgcps</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">autogcp2</span><span class="p">(</span><span class="n">mfile</span><span class="p">,</span> <span class="n">dbic</span><span class="p">,</span> <span class="n">srcbgd</span><span class="p">,</span> <span class="n">mmseg</span><span class="p">,</span> <span class="n">dbgc</span><span class="p">,</span> <span class="n">filref</span><span class="p">,</span> <span class="n">dbic_ref</span><span class="p">,</span> <span class="n">filedem</span><span class="p">,</span> <span class="n">dbec</span><span class="p">,</span> <span class="n">backelev</span><span class="p">,</span> <span class="n">elevref</span><span class="p">,</span> <span class="n">elevunit</span><span class="p">,</span> <span class="n">elfactor</span><span class="p">,</span> <span class="n">smplsrc</span><span class="p">,</span> <span class="n">algo</span><span class="p">,</span> <span class="n">searchr</span><span class="p">,</span> <span class="n">searchun</span><span class="p">,</span> <span class="n">minscore</span><span class="p">,</span> <span class="n">proc</span><span class="p">,</span> <span class="n">numgcps</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="k">print</span> <span class="s">&quot;&quot;</span>
    <span class="k">print</span> <span class="s">&quot;Automatic GCP Refinement Started&quot;</span>
    <span class="k">print</span> <span class="s">&quot;&quot;</span>

    <span class="nb">file</span> <span class="o">=</span>  <span class="n">in_file</span>
    <span class="n">dbgc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>      <span class="c"># Integer</span>
    <span class="n">mmseg</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">orbit</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">modeltyp</span> <span class="o">=</span> <span class="s">u&quot;SAT&quot;</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>      <span class="c"># Integer</span>
    <span class="n">reject</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>     <span class="c"># Float</span>
    <span class="n">writecp</span> <span class="o">=</span> <span class="s">u&quot;NO&quot;</span>
    <span class="n">lasc</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">imstat</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">gcprefn</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dbgc</span><span class="p">,</span> <span class="n">mmseg</span><span class="p">,</span> <span class="n">orbit</span><span class="p">,</span> <span class="n">modeltyp</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">reject</span><span class="p">,</span> <span class="n">writecp</span><span class="p">,</span> <span class="n">lasc</span><span class="p">,</span> <span class="n">imstat</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>


<span class="k">def</span> <span class="nf">rigorous_ortho</span><span class="p">(</span><span class="n">in_mfile</span><span class="p">,</span> <span class="n">out_ortho_mfile</span><span class="p">,</span> <span class="n">dem_file</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">):</span>
<span class="c"># ------------------------------------------------</span>
<span class="c">#  Calculate Rigorous Model and Orthorectify</span>
<span class="c"># ------------------------------------------------</span>
<span class="c"># This function simply calculates the physical model (toutin&#39;s model) and then orthorectifies</span>
<span class="c"># all of the data that is passed to this function.</span>

    <span class="k">print</span> <span class="s">&quot;Starting Rigorous Model Calculation&quot;</span>
    <span class="k">print</span> <span class="s">&quot;&quot;</span>

    <span class="n">mfile</span> <span class="o">=</span> <span class="n">in_mfile</span>
    <span class="n">dbgc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>      <span class="c"># Integer</span>
    <span class="n">mmseg</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">orbit</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mapunits</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">satmodel</span><span class="p">(</span><span class="n">mfile</span><span class="p">,</span> <span class="n">dbgc</span><span class="p">,</span> <span class="n">orbit</span><span class="p">,</span> <span class="n">mmseg</span><span class="p">,</span>  <span class="n">mapunits</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>

        <span class="n">fail_log</span><span class="p">(</span><span class="n">in_mfile</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

        <span class="n">fail_log</span><span class="p">(</span><span class="n">in_mfile</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">&quot;Starting Orthorectification&quot;</span>
    <span class="k">print</span> <span class="s">&quot;&quot;</span>

    <span class="n">mfile</span> <span class="o">=</span> <span class="n">in_mfile</span>
    <span class="n">dbic</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">mmseg</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">dbiw</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">srcbgd</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">filo</span> <span class="o">=</span> <span class="n">out_ortho_mfile</span>
    <span class="n">ftype</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">foptions</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">outbgd</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>
    <span class="n">ulx</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">uly</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">lrx</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">lry</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">edgeclip</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">tipostrn</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">mapunits</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">bxpxsz</span> <span class="o">=</span> <span class="s">u&quot;8&quot;</span>
    <span class="n">bypxsz</span> <span class="o">=</span> <span class="s">u&quot;8&quot;</span>
    <span class="n">filedem</span> <span class="o">=</span> <span class="n">dem_file</span>
    <span class="n">dbec</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">backelev</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>
    <span class="n">elevref</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">elevunit</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">elfactor</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c"># Float</span>
    <span class="n">proc</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
    <span class="n">sampling</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c"># Integer</span>
    <span class="n">resample</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ortho2</span><span class="p">(</span><span class="n">mfile</span><span class="p">,</span> <span class="n">dbic</span><span class="p">,</span> <span class="n">mmseg</span><span class="p">,</span> <span class="n">dbiw</span><span class="p">,</span> <span class="n">srcbgd</span><span class="p">,</span> <span class="n">filo</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">foptions</span><span class="p">,</span> <span class="n">outbgd</span><span class="p">,</span> <span class="n">ulx</span><span class="p">,</span> <span class="n">uly</span><span class="p">,</span> <span class="n">lrx</span><span class="p">,</span> <span class="n">lry</span><span class="p">,</span> <span class="n">edgeclip</span><span class="p">,</span> <span class="n">tipostrn</span><span class="p">,</span> <span class="n">mapunits</span><span class="p">,</span> <span class="n">bxpxsz</span><span class="p">,</span> <span class="n">bypxsz</span><span class="p">,</span> <span class="n">filedem</span><span class="p">,</span> <span class="n">dbec</span><span class="p">,</span> <span class="n">backelev</span><span class="p">,</span> <span class="n">elevref</span><span class="p">,</span> <span class="n">elevunit</span><span class="p">,</span> <span class="n">elfactor</span><span class="p">,</span> <span class="n">proc</span><span class="p">,</span> <span class="n">sampling</span><span class="p">,</span> <span class="n">resample</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>


<span class="c"># ------------------------------------------------</span>
<span class="c">#  User Input Parameters</span>
<span class="c"># ------------------------------------------------</span>
<span class="c"># This section provides user prompts, which allows the user to provide the</span>
<span class="c"># paths to input data, reference data and where the output data shouold be</span>
<span class="c"># written to.</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&#39;***************************************************************&#39;</span>
<span class="k">print</span> <span class="s">&#39;                   Setup Working Environment&#39;</span>
<span class="k">print</span> <span class="s">&#39;***************************************************************&#39;</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="n">in_dir</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Specify the input directory: &#39;</span><span class="p">)</span>
<span class="n">verify_dir</span><span class="p">(</span><span class="n">in_dir</span><span class="p">)</span>

<span class="n">files_list</span> <span class="o">=</span> <span class="n">get_inputs</span><span class="p">(</span><span class="n">in_dir</span><span class="p">,</span> <span class="s">&#39;*.tif&#39;</span><span class="p">,</span> <span class="s">&#39;NO&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>

<span class="n">out_root_dir</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Specify the output directory where outputs will be written to: &#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>

<span class="n">verify_dir</span><span class="p">(</span><span class="n">out_root_dir</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>

<span class="n">ref</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Specify the reference image for auto co-registration: &quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;&#39;</span>

<span class="n">dem</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Specify the DEM (Digital Elevation Model) for auto co-registration: &quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;&#39;</span>

<span class="k">for</span> <span class="n">validate</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ref</span><span class="p">,</span> <span class="n">dem</span><span class="p">]:</span> <span class="c"># Validates that the reference data exists</span>
    <span class="n">validate_files</span><span class="p">(</span><span class="n">validate</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;User Parameters Verified!&quot;</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span> <span class="c">#Current time in seconds since epoch</span>

<span class="c"># ------------------------------------------------</span>
<span class="c">#  Co-Registration control</span>
<span class="c"># ------------------------------------------------</span>
<span class="c"># This block calls the functions used to co-register the data in the stack</span>
<span class="c"># Two iterations are required. In the first iteration of the workflow, the reference</span>
<span class="c"># image must be a 3rd party reference dataset (e.g. Landsat). In this first iteration,</span>
<span class="c"># only the first image in the image stack will be orthorectified (based on GCPs</span>
<span class="c"># collected from the 3rd reference image.</span>
<span class="c"># In the second iteration, the script will use the ortho from the first image in</span>
<span class="c"># the stack as a reference to collect GCPs for the remaining images in the stack for</span>
<span class="c"># orthorectification</span>

<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">iter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;First iteration through Co-registration Workflow&quot;</span>
        <span class="k">print</span> <span class="s">&quot;&quot;</span>

        <span class="n">master_ingest_dir</span> <span class="o">=</span> <span class="n">out_root_dir</span> <span class="o">+</span> <span class="s">&#39;/master/ingest/&#39;</span>
        <span class="n">verify_dir</span><span class="p">(</span><span class="n">master_ingest_dir</span><span class="p">)</span>

        <span class="n">master_ingest_filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ntpath</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">files_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">master_ingest_file</span> <span class="o">=</span> <span class="n">master_ingest_dir</span> <span class="o">+</span> <span class="n">master_ingest_filename</span> <span class="o">+</span> <span class="s">&#39;.pix&#39;</span>

        <span class="k">print</span> <span class="s">&quot;Input file is: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">files_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span> <span class="s">&quot;Ingest file set to: &quot;</span><span class="p">,</span> <span class="n">master_ingest_file</span>
        <span class="n">ingest_formosat</span><span class="p">(</span><span class="n">files_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">master_ingest_file</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>

        <span class="n">gcp_work</span><span class="p">(</span><span class="n">master_ingest_file</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">dem</span><span class="p">)</span>

        <span class="n">master_ortho_dir</span> <span class="o">=</span> <span class="n">out_root_dir</span> <span class="o">+</span> <span class="s">&#39;/master/ortho/&#39;</span>
        <span class="n">verify_dir</span><span class="p">(</span><span class="n">master_ortho_dir</span><span class="p">)</span>

        <span class="n">master_ortho_filename</span> <span class="o">=</span> <span class="s">&quot;o&quot;</span> <span class="o">+</span> <span class="n">master_ingest_filename</span>
        <span class="n">master_ortho_file</span> <span class="o">=</span> <span class="n">master_ingest_dir</span> <span class="o">+</span> <span class="n">master_ortho_filename</span> <span class="o">+</span> <span class="s">&#39;.pix&#39;</span>

        <span class="n">rigorous_ortho</span><span class="p">(</span><span class="n">master_ingest_file</span><span class="p">,</span> <span class="n">master_ortho_file</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">out_root_dir</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;Second iteration through Co-registration Workflow&quot;</span>
        <span class="k">print</span> <span class="s">&quot;&quot;</span>

        <span class="n">stack_ingest_dir</span> <span class="o">=</span> <span class="n">out_root_dir</span> <span class="o">+</span> <span class="s">&#39;/stack/ingest/&#39;</span>
        <span class="n">verify_dir</span><span class="p">(</span><span class="n">stack_ingest_dir</span><span class="p">)</span>

        <span class="n">stack_ortho_dir</span> <span class="o">=</span> <span class="n">out_root_dir</span> <span class="o">+</span> <span class="s">&#39;/stack/ortho/&#39;</span>
        <span class="n">verify_dir</span><span class="p">(</span><span class="n">stack_ortho_dir</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">input_image</span> <span class="ow">in</span> <span class="n">files_list</span><span class="p">:</span>

            <span class="n">stack_ingest_filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ntpath</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">input_image</span><span class="p">))</span>
            <span class="n">stack_ingest_file</span> <span class="o">=</span> <span class="n">stack_ingest_dir</span> <span class="o">+</span> <span class="n">stack_ingest_filename</span> <span class="o">+</span> <span class="s">&#39;.pix&#39;</span>

            <span class="k">print</span> <span class="s">&quot;Input file is: &quot;</span><span class="p">,</span> <span class="n">input_image</span>
            <span class="k">print</span> <span class="s">&quot;&quot;</span>
            <span class="k">print</span> <span class="s">&quot;Ingest file set to: &quot;</span><span class="p">,</span> <span class="n">master_ingest_file</span>
            <span class="n">ingest_formosat</span><span class="p">(</span> <span class="n">input_image</span><span class="p">,</span> <span class="n">stack_ingest_file</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>

            <span class="n">gcp_work</span><span class="p">(</span><span class="n">stack_ingest_file</span><span class="p">,</span> <span class="n">master_ortho_file</span><span class="p">,</span> <span class="n">dem</span><span class="p">)</span>

            <span class="n">stack_ortho_filename</span> <span class="o">=</span> <span class="s">&quot;o&quot;</span> <span class="o">+</span> <span class="n">stack_ingest_filename</span>
            <span class="n">stack_ortho_file</span> <span class="o">=</span> <span class="n">stack_ortho_dir</span> <span class="o">+</span> <span class="n">stack_ortho_filename</span> <span class="o">+</span> <span class="s">&#39;.pix&#39;</span>

            <span class="n">rigorous_ortho</span><span class="p">(</span><span class="n">stack_ingest_file</span><span class="p">,</span> <span class="n">stack_ortho_file</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">out_root_dir</span><span class="p">)</span>


<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;***************************************************************&quot;</span>
<span class="k">print</span> <span class="s">&quot;               Completed Co-Registration Run&quot;</span>
<span class="k">print</span> <span class="s">&quot;***************************************************************&quot;</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>

<span class="n">end_time</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span> <span class="c">#Current time in seconds since epoch</span>

<span class="n">process_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="k">print</span> <span class="s">&quot;Total Processing took &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">process_time</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; seconds.&quot;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="automatically-identify-and-calculate-volume-of-new-stockpiles">
<h2>Automatically identify and calculate volume of new stockpiles<a class="headerlink" href="#automatically-identify-and-calculate-volume-of-new-stockpiles" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Python prints help documentation to the terminal/console for the specified function. This includes information
about the signature of the function (arguments that need to be passed) and information about what the function
does. Furthermore, the help document includes information about what input data is required and what output is
produced.</p>
<p>It is best to access this directly with the python interpreter in Geomatica&#8217;s Focus or using a terminal/console</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#****************************************************</span>
<span class="c">#</span>
<span class="c"># Automatic Extraction and Volumetric Calculation of</span>
<span class="c"># New Stock Piles</span>
<span class="c">#</span>
<span class="c">#         Mining and Construction Application</span>
<span class="c">#</span>
<span class="c">#****************************************************</span>

<span class="sd">&#39;&#39;&#39; Workflow - Primary Operations</span>
<span class="sd">1. Ingest Imagery (Geomatica)</span>
<span class="sd">2. Generate DSMs EPIPOLAR2 &amp; AUTODEM2 (Geomatica)</span>
<span class="sd">3. Calculate Change Image CHDETOP (Geomatica)</span>
<span class="sd">4. Extract New Stockpiles EXPOLRAS (Geomatica)</span>
<span class="sd">5. Calculate Sum of all pixels under each polygon Zonal Statistics (ArcPy)</span>
<span class="sd">6. Calculate unit conversion coefficient (m^3)</span>
<span class="sd">7. Convert to Polygon with Volume measures in Attributes Table&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">pci.camimport</span> <span class="kn">import</span> <span class="n">camimport</span>
<span class="kn">from</span> <span class="nn">pci.eoimport</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.epipolar2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.autodem2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.crproj</span> <span class="kn">import</span> <span class="n">crproj</span>
<span class="kn">from</span> <span class="nn">pci.exceptions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.link</span> <span class="kn">import</span> <span class="n">link</span>
<span class="kn">from</span> <span class="nn">pci.cpmmseg</span> <span class="kn">import</span> <span class="n">cpmmseg</span>
<span class="kn">from</span> <span class="nn">pci.chdetop</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.expolras</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.iia</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.fexport</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pci.ras2poly</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathcheck</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">calendar</span><span class="o">,</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">ntpath</span>

<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">arcpy.mapping</span>
<span class="k">print</span> <span class="s">&quot;ArcPy loaded successfully!&quot;</span>

<span class="k">def</span> <span class="nf">set_working_env</span><span class="p">():</span>
    <span class="c">#****************************************************</span>
    <span class="c">#           Get and verify User Parameters</span>
    <span class="c">#****************************************************</span>

    <span class="c">#Get Input data locations from users</span>
    <span class="n">test_raw_dir</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Folder to your raw images for building </span><span class="se">\&quot;</span><span class="s">Test</span><span class="se">\&quot;</span><span class="s"> DSM: &quot;</span><span class="p">)</span>
    <span class="n">ref_raw_dir</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Folder to your raw images for building </span><span class="se">\&quot;</span><span class="s">Reference</span><span class="se">\&quot;</span><span class="s"> DSM: &quot;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Provide mask file: &quot;</span><span class="p">)</span>
    <span class="n">in_dir_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_raw_dir</span><span class="p">,</span> <span class="n">ref_raw_dir</span><span class="p">]</span>

    <span class="c">#create Output_root_folder</span>
    <span class="n">output_root_dir</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;Specify the output root directory: &quot;</span><span class="p">)</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">output_root_dir</span><span class="p">)</span>

    <span class="c">#create working directories</span>
    <span class="n">working_dir_test</span> <span class="o">=</span> <span class="n">output_root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;working&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;test&#39;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">working_dir_test</span><span class="p">)</span>
    <span class="n">working_dir_ref</span> <span class="o">=</span> <span class="n">output_root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;working&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;ref&#39;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">working_dir_ref</span><span class="p">)</span>
    <span class="n">working_dir_analysis</span> <span class="o">=</span> <span class="n">output_root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;working&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;analysis&#39;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">working_dir_analysis</span><span class="p">)</span>

    <span class="c">#create results directory and</span>
    <span class="n">results_dir</span> <span class="o">=</span> <span class="n">output_root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;output&#39;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">results_dir</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">in_dir_list</span><span class="p">,</span> <span class="n">working_dir_test</span><span class="p">,</span> <span class="n">working_dir_ref</span><span class="p">,</span> <span class="n">working_dir_analysis</span><span class="p">,</span> \
    <span class="n">results_dir</span><span class="p">,</span> <span class="n">mask</span>


<span class="k">def</span> <span class="nf">ap_ingest</span><span class="p">(</span><span class="n">raw_dir</span><span class="p">,</span> <span class="n">working_dir</span><span class="p">):</span>
    <span class="c">#****************************************************</span>
    <span class="c">#            Import/Ingest Raw Airphotos</span>
    <span class="c">#****************************************************</span>

    <span class="n">raw_image_list</span> <span class="o">=</span> <span class="n">get_inputs</span><span class="p">(</span><span class="n">raw_dir</span><span class="p">,</span> <span class="s">&quot;*.tif&quot;</span><span class="p">,</span> <span class="s">&quot;NO&quot;</span><span class="p">)</span>

    <span class="n">verify_dir</span><span class="p">(</span><span class="n">working_dir</span><span class="p">)</span>

    <span class="n">ingested_dir</span> <span class="o">=</span> <span class="n">working_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;ingested&quot;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">ingested_dir</span><span class="p">)</span>

    <span class="c">#Create Link file</span>
    <span class="k">for</span> <span class="n">raw_image</span> <span class="ow">in</span> <span class="n">raw_image_list</span><span class="p">:</span>
        <span class="n">fili</span> <span class="o">=</span> <span class="n">raw_image</span>
        <span class="n">file_no_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">raw_image</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ingested_image</span> <span class="o">=</span> <span class="n">ingested_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">ntpath</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_no_extension</span><span class="p">)</span>
        <span class="n">filo</span> <span class="o">=</span> <span class="n">ingested_image</span> <span class="o">+</span> <span class="s">&quot;.pix&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">link</span><span class="p">(</span> <span class="n">fili</span><span class="p">,</span> <span class="n">filo</span><span class="p">,</span> <span class="p">[]</span> <span class="p">)</span>
        <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">e</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">e</span>

    <span class="c">#return ingested_dir, working_dir</span>


<span class="k">def</span> <span class="nf">config_oe_prj</span><span class="p">(</span><span class="n">raw_dir</span><span class="p">,</span> <span class="n">working_dir</span><span class="p">):</span>
    <span class="c">#Create OrthoEngine project file</span>
    <span class="n">mfile</span> <span class="o">=</span> <span class="n">working_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;ingested&quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;*.pix&quot;</span>
    <span class="n">oeproj</span> <span class="o">=</span> <span class="n">working_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;oe_ref.prj&quot;</span>
    <span class="n">mapunits</span> <span class="o">=</span> <span class="s">&quot;UTM 17 D122&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">crproj</span><span class="p">(</span> <span class="n">mfile</span><span class="p">,</span> <span class="p">[],</span> <span class="n">oeproj</span><span class="p">,</span> <span class="s">&quot;APDU&quot;</span><span class="p">,</span> <span class="n">mapunits</span> <span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="c">#Import Camera Parameters</span>
    <span class="n">camfile</span> <span class="o">=</span> <span class="n">raw_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;camera_calib.xml&quot;</span>
    <span class="n">oe_final</span> <span class="o">=</span> <span class="n">working_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;oe_configured.prj&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">camimport</span><span class="p">(</span> <span class="n">oeproj</span><span class="p">,</span> <span class="n">camfile</span><span class="p">,</span> <span class="n">oe_final</span> <span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="c">#Import Exterior Orientation File</span>
    <span class="n">eofile</span> <span class="o">=</span> <span class="n">raw_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;eo.txt&quot;</span>
    <span class="n">mapunits</span> <span class="o">=</span> <span class="s">&quot;UTM 17 D122&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">eoimport</span><span class="p">(</span> <span class="n">oe_final</span><span class="p">,</span> <span class="n">eofile</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">mapunits</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="k">return</span> <span class="n">oe_final</span>


<span class="k">def</span> <span class="nf">extract_dsm</span><span class="p">(</span><span class="n">final_oe_proj</span><span class="p">,</span> <span class="n">work_dir</span><span class="p">,</span> <span class="n">dsm_type</span><span class="p">):</span>
    <span class="c">#****************************************************</span>
    <span class="c">#            Extract Digital Surface Model</span>
    <span class="c">#****************************************************</span>
    <span class="n">ingested_dir</span> <span class="o">=</span> <span class="n">work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;ingested&quot;</span>
    <span class="n">ingest_image_list</span> <span class="o">=</span> <span class="n">get_inputs</span><span class="p">(</span><span class="n">ingested_dir</span><span class="p">,</span> <span class="s">&quot;*.pix&quot;</span><span class="p">,</span> <span class="s">&quot;NO&quot;</span><span class="p">)</span>

    <span class="c">#Create math model from OE to ingested images</span>
    <span class="k">for</span> <span class="n">ingest_image</span> <span class="ow">in</span> <span class="n">ingest_image_list</span><span class="p">:</span>
        <span class="n">oeproj</span> <span class="o">=</span> <span class="n">final_oe_proj</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="n">ingest_image</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cpmmseg</span><span class="p">(</span><span class="n">oeproj</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">e</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">e</span>

    <span class="c">#Set Epipolar Parameters</span>
    <span class="n">mfile</span> <span class="o">=</span> <span class="n">ingested_dir</span>
    <span class="n">epi_outdir</span> <span class="o">=</span> <span class="n">work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;epipolars&#39;</span>

    <span class="n">verify_dir</span><span class="p">(</span><span class="n">epi_outdir</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">epipolar2</span><span class="p">(</span> <span class="n">mfile</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s">u&quot;&quot;</span><span class="p">,</span> <span class="s">u&quot;opt&quot;</span><span class="p">,</span> <span class="p">[],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">epi_outdir</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">u&quot;&quot;</span><span class="p">,</span> <span class="s">u&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="n">dsm_outdir</span> <span class="o">=</span> <span class="n">work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;dsm_working&#39;</span>
    <span class="n">mfile</span> <span class="o">=</span> <span class="n">epi_outdir</span>
    <span class="n">outdir</span> <span class="o">=</span> <span class="n">dsm_outdir</span>
    <span class="n">filedem</span> <span class="o">=</span> <span class="n">work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;dsm_&quot;</span> <span class="o">+</span> <span class="n">dsm_type</span> <span class="o">+</span> <span class="s">&quot;.pix&quot;</span>
    <span class="n">pxszout</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>

    <span class="n">verify_dir</span><span class="p">(</span><span class="n">dsm_outdir</span><span class="p">)</span>

    <span class="n">autodem2</span><span class="p">(</span> <span class="n">mfile</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s">&#39;high&#39;</span><span class="p">,</span>
            <span class="s">&#39;hilly&#39;</span><span class="p">,</span> <span class="s">&#39;32r&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="p">,</span>
            <span class="n">filedem</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;UTM 17 D122&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">pxszout</span><span class="p">,</span> <span class="s">&#39;blend&#39;</span> <span class="p">)</span>

    <span class="c">#This block is here, because of a bug. It is a workaround.</span>
    <span class="n">filedem_no_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filedem</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">new_filedem</span> <span class="o">=</span> <span class="n">filedem_no_extension</span> <span class="o">+</span> <span class="s">&quot;_temp.pix&quot;</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">filedem</span><span class="p">,</span> <span class="n">new_filedem</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">new_filedem</span>

<span class="k">def</span> <span class="nf">change_extract</span><span class="p">(</span><span class="n">test_dem</span><span class="p">,</span> <span class="n">ref_dem</span><span class="p">,</span> <span class="n">mask_file</span><span class="p">,</span> <span class="n">analysis_dir</span><span class="p">):</span>
    <span class="c">#****************************************************</span>
    <span class="c">#           Change Detection and Extraction</span>
    <span class="c">#****************************************************</span>
    <span class="n">dsm_diff</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stock_diff.pix&quot;</span>
    <span class="n">new_stockpiles</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpiles.pix&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c">#Transfer the vector mask to the test image</span>
        <span class="n">iia</span><span class="p">(</span> <span class="n">mask_file</span><span class="p">,</span> <span class="n">test_dem</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[]</span> <span class="p">)</span>

        <span class="c">#Run Optical Change Detection to get DSM difference image (elevation change)</span>
        <span class="n">chdetop</span><span class="p">(</span> <span class="n">test_dem</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref_dem</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dsm_diff</span><span class="p">,</span> <span class="s">&quot;chandiff&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">test_dem</span><span class="p">,</span> <span class="s">&quot;pix&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>

        <span class="c">#Extract stockpiles as polygons, as determined by elevation change in the AOI (determined by mask)</span>
        <span class="n">expolras</span><span class="p">(</span> <span class="n">dsm_diff</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;pixelvalue&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">35</span><span class="p">],</span> <span class="p">[],</span> <span class="n">new_stockpiles</span><span class="p">,</span> <span class="s">&quot;pix&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>

    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="c">#Export the analysis files for use in ArcPy</span>

    <span class="n">tif_stock_diff</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stock_diff.tif&quot;</span>
    <span class="n">shp_stockpiles</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpiles.shp&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">fexport</span><span class="p">(</span> <span class="n">dsm_diff</span><span class="p">,</span> <span class="n">tif_stock_diff</span><span class="p">,</span> <span class="p">[</span><span class="mi">870</span><span class="p">,</span> <span class="mi">1404</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">350</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s">&quot;TIF&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>

        <span class="n">fexport</span><span class="p">(</span> <span class="n">new_stockpiles</span><span class="p">,</span> <span class="n">shp_stockpiles</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s">&quot;shp&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>

    <span class="k">except</span> <span class="n">PCIException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

    <span class="k">return</span> <span class="n">tif_stock_diff</span><span class="p">,</span> <span class="n">shp_stockpiles</span>


<span class="k">def</span> <span class="nf">calc_area</span><span class="p">(</span><span class="n">stock_diff</span><span class="p">,</span> <span class="n">stockpiles_vec</span><span class="p">,</span> <span class="n">analysis_dir</span><span class="p">):</span>
    <span class="c">#****************************************************</span>
    <span class="c">#           Calculate volume for each stockpile</span>
    <span class="c">#****************************************************</span>
    <span class="n">env</span><span class="o">.</span><span class="n">worspace</span> <span class="o">=</span> <span class="n">analysis_dir</span>
    <span class="n">arcpy_work_dir</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;arcpy_work&quot;</span>
    <span class="n">verify_dir</span><span class="p">(</span><span class="n">arcpy_work_dir</span><span class="p">)</span>

    <span class="c"># Execute ZonalStatistics</span>
    <span class="n">arcpy</span><span class="o">.</span><span class="n">CheckOutExtension</span><span class="p">(</span><span class="s">&quot;Spatial&quot;</span><span class="p">)</span>
    <span class="n">outZonalStatistics</span> <span class="o">=</span> <span class="n">ZonalStatistics</span><span class="p">(</span><span class="n">stockpiles_vec</span><span class="p">,</span> <span class="s">&quot;PixelCount&quot;</span><span class="p">,</span> <span class="n">stock_diff</span><span class="p">,</span> <span class="s">&quot;SUM&quot;</span><span class="p">,</span> <span class="s">&quot;NODATA&quot;</span><span class="p">)</span>

    <span class="n">zonal_stats_file</span> <span class="o">=</span> <span class="n">arcpy_work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpile_sum.tif&quot;</span>
    <span class="n">outZonalStatistics</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">zonal_stats_file</span><span class="p">)</span>

    <span class="c">#Convert sum to volume measure in m^3 (pixel size is 0.9m)</span>
    <span class="n">outTimes</span> <span class="o">=</span> <span class="n">Raster</span><span class="p">(</span><span class="n">zonal_stats_file</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.81</span>

    <span class="n">zonal_stats_m_cubed</span> <span class="o">=</span> <span class="n">arcpy_work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpile_vol_m3.tif&quot;</span>
    <span class="n">outTimes</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">zonal_stats_m_cubed</span><span class="p">)</span>

    <span class="c">#Convert raster from 64bit to 32bit float</span>
    <span class="n">zonal_stats_m_cubed_32</span> <span class="o">=</span> <span class="n">arcpy_work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpile_vol_m3_32f.tif&quot;</span>
    <span class="n">arcpy</span><span class="o">.</span><span class="n">CopyRaster_management</span><span class="p">(</span><span class="n">zonal_stats_m_cubed</span><span class="p">,</span> <span class="n">zonal_stats_m_cubed_32</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;32_BIT_FLOAT&quot;</span><span class="p">)</span>

    <span class="c">#Convert raster to polygons</span>
    <span class="n">stockpiles</span> <span class="o">=</span> <span class="n">analysis_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;stockpiles_vol_m3.pix&quot;</span>
    <span class="n">expolras</span><span class="p">(</span> <span class="n">zonal_stats_m_cubed_32</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;pixelvalue&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">stockpiles</span><span class="p">,</span> <span class="s">&quot;pix&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">)</span>


<span class="k">def</span> <span class="nf">prepare_output</span><span class="p">(</span><span class="n">root_dir</span><span class="p">):</span>

    <span class="k">print</span> <span class="s">&quot;Preparing output files&quot;</span>

    <span class="n">in_file</span> <span class="o">=</span> <span class="s">r&quot;D:\live_webinar\GeomaticaArcGIS_Mining\Misc\ag\NewStockPiles_Volume.mxd&quot;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;NewStockPiles.mxd&quot;</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="n">in_file</span><span class="p">,</span> <span class="n">output_file</span> <span class="p">)</span>

    <span class="k">print</span> <span class="s">&quot;&quot;</span>
    <span class="k">print</span> <span class="s">&quot;&quot;</span>
    <span class="k">print</span> <span class="s">&quot;Opening ArcGIS Project and Centering on Construction Site...&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="sd">&#39;&#39;&#39;final_layers_dir = results_dir + os.sep + &#39;final_layers&#39;&#39;&#39;</span>


<span class="c">#****************************************************</span>
<span class="c">#                   Start Script</span>
<span class="c">#****************************************************</span>
<span class="c">#Run the set_working_env function, responsible for acquiring input information,</span>
<span class="c">#setting up output and working directories. The directories of interest are passed</span>
<span class="c">#back to the following variables</span>
<span class="n">in_dirs</span><span class="p">,</span> <span class="n">working_test</span><span class="p">,</span> <span class="n">working_ref</span><span class="p">,</span> <span class="n">working_analysis</span><span class="p">,</span> <span class="n">result_root_dir</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">set_working_env</span><span class="p">()</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span> <span class="c">#Current time in seconds since epoch</span>

<span class="k">for</span> <span class="n">input_dir</span> <span class="ow">in</span> <span class="n">in_dirs</span><span class="p">:</span>
    <span class="c">#print in_dirs.index(input_dir)</span>
    <span class="k">if</span> <span class="n">in_dirs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ap_ingest</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">working_test</span><span class="p">)</span>
        <span class="n">final_oe_prj</span> <span class="o">=</span> <span class="n">config_oe_prj</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">working_test</span><span class="p">)</span>
        <span class="n">out_dsm_test</span> <span class="o">=</span> <span class="n">extract_dsm</span><span class="p">(</span><span class="n">final_oe_prj</span><span class="p">,</span> <span class="n">working_test</span><span class="p">,</span> <span class="s">&#39;test&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">in_dirs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ap_ingest</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">working_ref</span><span class="p">)</span>
        <span class="n">final_oe_prj</span> <span class="o">=</span> <span class="n">config_oe_prj</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">working_ref</span><span class="p">)</span>
        <span class="n">out_dsm_ref</span> <span class="o">=</span> <span class="n">extract_dsm</span><span class="p">(</span><span class="n">final_oe_prj</span><span class="p">,</span> <span class="n">working_ref</span><span class="p">,</span> <span class="s">&#39;ref&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Something went wrong&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">out_dsm_test = working_test + os.sep + &quot;dsm_test_temp.pix&quot;</span>
<span class="sd">out_dsm_ref = working_ref + os.sep + &quot;dsm_ref_temp.pix&quot;&#39;&#39;&#39;</span>

<span class="n">stockpile_diff_file</span><span class="p">,</span> <span class="n">vec_stockpiles</span> <span class="o">=</span> <span class="n">change_extract</span><span class="p">(</span> <span class="n">out_dsm_test</span><span class="p">,</span> <span class="n">out_dsm_ref</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">working_analysis</span> <span class="p">)</span>
<span class="n">calc_area</span><span class="p">(</span><span class="n">stockpile_diff_file</span><span class="p">,</span> <span class="n">vec_stockpiles</span><span class="p">,</span> <span class="n">working_analysis</span><span class="p">)</span>
<span class="n">prepare_output</span><span class="p">(</span><span class="n">result_root_dir</span><span class="p">)</span>

<span class="n">end_time</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">())</span> <span class="c">#Current time in seconds since epoch</span>
<span class="n">process_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>
<span class="k">print</span> <span class="s">&quot;Total Processing Took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">process_time</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="orthorectification-pansharpening-and-mosaicking-of-satellite-imagery">
<h2>Orthorectification, pansharpening and mosaicking of satellite imagery<a class="headerlink" href="#orthorectification-pansharpening-and-mosaicking-of-satellite-imagery" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Python prints help documentation to the terminal/console for the specified function. This includes information
about the signature of the function (arguments that need to be passed) and information about what the function
does. Furthermore, the help document includes information about what input data is required and what output is
produced.</p>
<p>It is best to access this directly with the python interpreter in Geomatica&#8217;s Focus or using a terminal/console</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#****************************************************</span>
<span class="c">#</span>
<span class="c"># Automatic Extraction and Volumetric Calculation of</span>
<span class="c"># New Stock Piles</span>
<span class="c">#</span>
<span class="c">#         Mining and Construction Application</span>
<span class="c">#</span>
<span class="c">#**********</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/PCI_Logo_med.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><strong>Workflow Examples for the Left-side of Your Brain</strong></a><ul>
<li><a class="reference internal" href="#co-register-image-stack">Co-register image stack</a></li>
<li><a class="reference internal" href="#automatically-identify-and-calculate-volume-of-new-stockpiles">Automatically identify and calculate volume of new stockpiles</a></li>
<li><a class="reference internal" href="#orthorectification-pansharpening-and-mosaicking-of-satellite-imagery">Orthorectification, pansharpening and mosaicking of satellite imagery</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/geomatica_cookbook_complete_workflows.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="index.html">Geomatica Cookbook 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Shawn Melamed.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>